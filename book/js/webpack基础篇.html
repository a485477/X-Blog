<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 常用的配置详解 | Hello VuePress</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/X-Blog/assets/css/0.styles.6c2272d3.css" as="style"><link rel="preload" href="/X-Blog/assets/js/app.0bfbaa4e.js" as="script"><link rel="preload" href="/X-Blog/assets/js/2.b59166c8.js" as="script"><link rel="preload" href="/X-Blog/assets/js/14.ed291892.js" as="script"><link rel="prefetch" href="/X-Blog/assets/js/10.7e127b0c.js"><link rel="prefetch" href="/X-Blog/assets/js/11.47fd0dab.js"><link rel="prefetch" href="/X-Blog/assets/js/12.a78c0a42.js"><link rel="prefetch" href="/X-Blog/assets/js/13.8bb8a80c.js"><link rel="prefetch" href="/X-Blog/assets/js/15.51e122f5.js"><link rel="prefetch" href="/X-Blog/assets/js/16.deb9f46e.js"><link rel="prefetch" href="/X-Blog/assets/js/17.63d6673a.js"><link rel="prefetch" href="/X-Blog/assets/js/18.d566475e.js"><link rel="prefetch" href="/X-Blog/assets/js/19.607e39db.js"><link rel="prefetch" href="/X-Blog/assets/js/20.80d1d4ee.js"><link rel="prefetch" href="/X-Blog/assets/js/21.1a388974.js"><link rel="prefetch" href="/X-Blog/assets/js/22.3aa8932e.js"><link rel="prefetch" href="/X-Blog/assets/js/23.aa7debfe.js"><link rel="prefetch" href="/X-Blog/assets/js/3.ab8434fc.js"><link rel="prefetch" href="/X-Blog/assets/js/4.e258bf78.js"><link rel="prefetch" href="/X-Blog/assets/js/5.3218ca1e.js"><link rel="prefetch" href="/X-Blog/assets/js/6.79cd8fe8.js"><link rel="prefetch" href="/X-Blog/assets/js/7.cb72ace3.js"><link rel="prefetch" href="/X-Blog/assets/js/8.8b36ea1a.js"><link rel="prefetch" href="/X-Blog/assets/js/9.3c935d94.js">
    <link rel="stylesheet" href="/X-Blog/assets/css/0.styles.6c2272d3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/X-Blog/" class="home-link router-link-active"><!----> <span class="site-name">Hello VuePress</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/X-Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/X-Blog/blogs/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/X-Blog/book/" class="nav-link router-link-active">
  前端随笔
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/X-Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/X-Blog/blogs/" class="nav-link">
  博客
</a></div><div class="nav-item"><a href="/X-Blog/book/" class="nav-link router-link-active">
  前端随笔
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/X-Blog/book/js/promise.html" class="sidebar-link">将请求合并</a></li><li><a href="/X-Blog/book/js/webpack基础篇.html" class="active sidebar-link">webpack 常用的配置详解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/X-Blog/book/js/webpack基础篇.html#context-string" class="sidebar-link">context(string)</a></li><li class="sidebar-sub-header"><a href="/X-Blog/book/js/webpack基础篇.html#node-object" class="sidebar-link">node(object)</a></li><li class="sidebar-sub-header"><a href="/X-Blog/book/js/webpack基础篇.html#output-object" class="sidebar-link">output(object)</a></li><li class="sidebar-sub-header"><a href="/X-Blog/book/js/webpack基础篇.html#resolve-object" class="sidebar-link">resolve(object)</a></li><li class="sidebar-sub-header"><a href="/X-Blog/book/js/webpack基础篇.html#entry-string-array-object" class="sidebar-link">entry(string|array|object)</a></li><li class="sidebar-sub-header"><a href="/X-Blog/book/js/webpack基础篇.html#optimization-object" class="sidebar-link">optimization(object)</a></li></ul></li><li><a href="/X-Blog/book/js/webpack配置小技巧.html" class="sidebar-link">webpack配置小技巧</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>使用说明</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-常用的配置详解"><a href="#webpack-常用的配置详解" class="header-anchor">#</a> webpack 常用的配置详解</h1> <h2 id="context-string"><a href="#context-string" class="header-anchor">#</a> <code>context(string)</code></h2> <blockquote><p>webpack配置上下文路径，默认是cmd的脚本路径，设置了以后就是独立于程序的路径.</p></blockquote> <hr> <h2 id="node-object"><a href="#node-object" class="header-anchor">#</a> <code>node(object)</code></h2> <blockquote><p>提供给其他环境的一个全局属性。暂时用不太到。</p></blockquote> <hr> <h2 id="output-object"><a href="#output-object" class="header-anchor">#</a> <code>output(object)</code></h2> <blockquote><p>定义webpack输出内容</p></blockquote> <p><code>path（string）</code>：</p> <p>对应一个绝对路径, 定义成果物输出的地方.</p> <p><code>output.filename（string|function）</code>：</p> <p>指定每一个bundle的名称，这些bundle将会写入到output.path指定的目录下，写法有很多种。</p> <div class="language- extra-class"><pre><code>'[name].js' 与入口名称的name对应
'[hash].js' 每次构建生成的hash值
'[id].js' 使用内部的chunk id
'[chunkhash].js'  基于每个chunk的hash值
</code></pre></div><p>虽然说是指定文件名，但还是可以传入'js/[hash].js'这样的格式.</p> <p>此选项也不会影响那些按需加载chunk的名字，对于这些文件，可以配置chunkFilename</p> <p><code>chunkFilename（string）</code>：</p> <p>此选项决定了非入口(non-entry) chunk 文件的名称。比如那些按需加载的。</p> <p>chunkFilename的模板参数和filename一样，默认使用'[id].js'这样的格式。所以打包出来的总是0.js。</p> <p><code>publicPath（string）</code>：</p> <p>一般用来指定那些按需加载的模块的基本路径，因为打包出来的文件大多会放在cdn服务上，会配置其他的域名。</p> <div class="language-js extra-class"><pre class="language-js"><code>publicPath<span class="token operator">:</span> <span class="token string">&quot;https://cdn.example.com/assets/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// CDN（总是 HTTPS 协议）</span>
publicPath<span class="token operator">:</span> <span class="token string">&quot;//cdn.example.com/assets/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// CDN (协议相同)</span>
publicPath<span class="token operator">:</span> <span class="token string">&quot;/assets/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 相对于服务(server-relative)</span>
publicPath<span class="token operator">:</span> <span class="token string">&quot;assets/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 相对于 HTML 页面</span>
publicPath<span class="token operator">:</span> <span class="token string">&quot;../assets/&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 相对于 HTML 页面</span>
publicPath<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 相对于 HTML 页面（目录相同）</span>
</code></pre></div><hr> <h2 id="resolve-object"><a href="#resolve-object" class="header-anchor">#</a> <code>resolve(object)</code></h2> <blockquote><p>配置模块如何解析。例如，当在 ES2015 中调用 import &quot;lodash&quot;，resolve 选项能够对 webpack 查找 &quot;lodash&quot; 的方式去做修改。</p></blockquote> <p><code>resolve.alias</code>:</p> <p>一般用于常见模块的的路径映射，典型的例子如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 一般vue的脚手架都会这么配置一个@变量</span>
        <span class="token string">&quot;@&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// index.js</span>
<span class="token comment">// 快捷导入</span>
<span class="token keyword">import</span> compass <span class="token keyword">from</span> <span class="token string">'@/component/compass'</span>
</code></pre></div><p>还可以后面加$表示精准匹配，和正则差不多</p> <div class="language-js extra-class"><pre class="language-js"><code>alias<span class="token operator">:</span> <span class="token punctuation">{</span>
  xyz$<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'path/to/file.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// index.js</span>
<span class="token keyword">import</span> Test1 <span class="token keyword">from</span> <span class="token string">'xyz'</span><span class="token punctuation">;</span> <span class="token comment">// 精确匹配，所以 path/to/file.js 被解析和导入</span>
<span class="token keyword">import</span> Test2 <span class="token keyword">from</span> <span class="token string">'xyz/file.js'</span><span class="token punctuation">;</span> <span class="token comment">// 非精确匹配，触发普通解析</span>
</code></pre></div><p><code>resolve.extensions</code>:</p> <p>自动解析确定的扩展。默认值为：</p> <div class="language-js extra-class"><pre class="language-js"><code>extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.json&quot;</span><span class="token punctuation">]</span>

<span class="token comment">// import 的时候就不用写后缀了</span>
<span class="token keyword">import</span> Test2 <span class="token keyword">from</span> <span class="token string">'xyz/file'</span><span class="token punctuation">;</span>
</code></pre></div><p>这里有个优化点，应该尽量将常见的放在数组前面，以快速遍历解析。</p> <p><code>resolve.modules</code>:</p> <p>告诉 webpack 解析模块时应该搜索的目录。</p> <p>绝对路径和相对路径都能使用，但是要知道它们之间有一点差异。</p> <p>如果你想要添加一个目录到模块搜索目录，此目录优先于 node_modules/ 搜索：</p> <div class="language-js extra-class"><pre class="language-js"><code>modules<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">]</span>
</code></pre></div><hr> <h2 id="entry-string-array-object"><a href="#entry-string-array-object" class="header-anchor">#</a> <code>entry(string|array|object)</code></h2> <p>简单规则：每个 HTML 页面都有一个入口起点。单页应用(SPA)：一个入口起点，多页应用(MPA)：多个入口起点。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 普通的单入口，只打包出一个相关包</span>
entry<span class="token operator">:</span> <span class="token string">'src/index.js'</span>

<span class="token comment">// 数组的格式会，将数组的文件打包到一个文件里</span>
entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/index/js'</span><span class="token punctuation">,</span> <span class="token string">'src/app.js'</span><span class="token punctuation">]</span>

<span class="token comment">// 以对象的形式，就是打包成多个包</span>
entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token string">'src/main.js'</span><span class="token punctuation">,</span>
    verdor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">,</span> <span class="token string">'loash'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 还可以传入函数，动态入口</span>

<span class="token function-variable function">entry</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'./demo'</span>
</code></pre></div><hr> <h2 id="optimization-object"><a href="#optimization-object" class="header-anchor">#</a> <code>optimization(object)</code></h2> <blockquote><p>定义编译过程chunk的分割逻辑，以前是commonschunkplugin,现在以声名式表现</p></blockquote> <p><code>optimization.minimize</code>:</p> <p>默认为true，效果就是压缩js代码。</p> <p><code>optimization.minimizer</code>:</p> <p>使用第三方插件压缩代码，与plugins传入方式一样，官方的解决方案是TerserWebpack.</p> <p><code>optimization.splitChunks</code>:</p> <p>webpack将根据以下条件自动分割块：</p> <ol><li>可以共享新块，或者模块来自node_modules文件夹</li> <li>新的块将大于30kb（在min + gz之前）</li> <li>按需加载块时并行请求的最大数量将小于或等于6</li> <li>初始页面加载时并行请求的最大数量将小于或等于4
当试图满足最后两个条件时，最好使用较大的块。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 默认配置</span>
splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 有效值为all，async和initial, 意义就是根据不同的策略打包模块
     * async 表示 只分割异步加载的模块。
     * all 同时分割同步与异步加载的模块, 同步代码不会自动分开打包，可以再cacheGroups里指定。
     * inifial 也会同时打包同步和异步，但是异步内部的引入不再考虑，直接打包在一起.
    */</span>
    chunks<span class="token operator">:</span> <span class="token string">'async'</span><span class="token punctuation">,</span>
    <span class="token comment">// 生成块的最小大小（以字节为单位）。</span>
    minSize<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
    minRemainingSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    maxSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token comment">// 最小公用模块次数，默认为1</span>
    minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token comment">// 按需加载时候最大的并行请求数</span>
    maxAsyncRequests<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token comment">// 一个入口最大的并行请求数</span>
    maxInitialRequests<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    automaticNameDelimiter<span class="token operator">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span>
    automaticNameMaxLength<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
    <span class="token comment">// 缓存策略，默认设置了分割node_modules和公用模块。内部的参数可以和覆盖外部的参数。</span>
    cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        defaultVendors<span class="token operator">:</span> <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
            priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span>
            reuseExistingChunk<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 例子</span>
cacheGroup<span class="token operator">:</span><span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/a\.js/</span><span class="token punctuation">,</span><span class="token comment">//匹配规则</span>
        minChunks<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">//重写公用chunks的次数</span>
        chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span><span class="token comment">//重写文件名称</span>
        enforce<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//强制生成</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/X-Blog/book/js/promise.html" class="prev">
        将请求合并
      </a></span> <span class="next"><a href="/X-Blog/book/js/webpack配置小技巧.html">
        webpack配置小技巧
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/X-Blog/assets/js/app.0bfbaa4e.js" defer></script><script src="/X-Blog/assets/js/2.b59166c8.js" defer></script><script src="/X-Blog/assets/js/14.ed291892.js" defer></script>
  </body>
</html>
